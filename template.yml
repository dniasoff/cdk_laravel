"Resources:\n  laraveldemostaticcontentproductionFAB2CE06:\n    Type: AWS::S3::Bucket\n    Properties:\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n      WebsiteConfiguration:\n        ErrorDocument: error.html\n        IndexDocument: index.html\n    UpdateReplacePolicy: Delete\n    DeletionPolicy: Delete\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravel-demo-static-content-production/Resource\n  laraveldemostaticcontentproductionPolicy3670FDCA:\n    Type: AWS::S3::BucketPolicy\n    Properties:\n      Bucket:\n        Ref: laraveldemostaticcontentproductionFAB2CE06\n      PolicyDocument:\n        Statement:\n          - Action: s3:GetObject\n            Effect: Allow\n            Principal: \"*\"\n            Resource:\n              Fn::Join:\n                - \"\"\n                - - Fn::GetAtt:\n                      - laraveldemostaticcontentproductionFAB2CE06\n                      - Arn\n                  - /*\n        Version: \"2012-10-17\"\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravel-demo-static-content-production/Policy/Resource\n  SiteDistributionCFDistribution209CF7F5:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        Aliases:\n          - production-static.kodespace.co.uk\n        DefaultCacheBehavior:\n          AllowedMethods:\n            - GET\n            - HEAD\n          CachedMethods:\n            - GET\n            - HEAD\n          Compress: true\n          ForwardedValues:\n            Cookies:\n              Forward: none\n            QueryString: false\n          TargetOriginId: origin1\n          ViewerProtocolPolicy: redirect-to-https\n        DefaultRootObject: index.html\n        Enabled: true\n        HttpVersion: http2\n        IPV6Enabled: true\n        Origins:\n          - ConnectionAttempts: 3\n            ConnectionTimeout: 10\n            CustomOriginConfig:\n              HTTPPort: 80\n              HTTPSPort: 443\n              OriginKeepaliveTimeout: 5\n              OriginProtocolPolicy: http-only\n              OriginReadTimeout: 30\n              OriginSSLProtocols:\n                - TLSv1.2\n            DomainName:\n              Fn::Select:\n                - 2\n                - Fn::Split:\n                    - /\n                    - Fn::GetAtt:\n                        - laraveldemostaticcontentproductionFAB2CE06\n                        - WebsiteURL\n            Id: origin1\n        PriceClass: PriceClass_100\n        ViewerCertificate:\n          AcmCertificateArn:\n            Fn::ImportValue: laravel-demo-vpc:ExportsOutputFnGetAttSiteCertificateCertificateRequestorResource6021082AArn67FD365D\n          MinimumProtocolVersion: TLSv1.1_2016\n          SslSupportMethod: sni-only\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/SiteDistribution/CFDistribution\n  SiteAliasRecord3C0AF5BF:\n    Type: AWS::Route53::RecordSet\n    Properties:\n      Name: production-static.kodespace.co.uk.\n      Type: A\n      AliasTarget:\n        DNSName:\n          Fn::GetAtt:\n            - SiteDistributionCFDistribution209CF7F5\n            - DomainName\n        HostedZoneId:\n          Fn::FindInMap:\n            - AWSCloudFrontPartitionHostedZoneIdMap\n            - Ref: AWS::Partition\n            - zoneId\n      HostedZoneId: Z016552312S0N2LCUKQCF\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/SiteAliasRecord/Resource\n  FargateCluster955EED67:\n    Type: AWS::ECS::Cluster\n    Properties:\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/Fargate Cluster/Resource\n  clusterNameB220FB68:\n    Type: AWS::SSM::Parameter\n    Properties:\n      Type: String\n      Value:\n        Ref: FargateCluster955EED67\n      Name: /laravel-demo/production/clusterName\n      Tags:\n        branch: master\n        service: laravel-demo\n        stack_type: cdk\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/clusterName/Resource\n  DnsNamespaceE8F044C2:\n    Type: AWS::ServiceDiscovery::PrivateDnsNamespace\n    Properties:\n      Name: http-api.local\n      Vpc:\n        Fn::ImportValue: laravel-demo-vpc:ExportsOutputReflaraveldemovpcvpcD90D1D43F0199DB5\n      Description: Private DnsNamespace for Microservices\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/DnsNamespace/Resource\n  ecsTaskExecutionRole34F54B99:\n    Type: AWS::IAM::Role\n    Properties:\n      AssumeRolePolicyDocument:\n        Statement:\n          - Action: sts:AssumeRole\n            Effect: Allow\n            Principal:\n              Service: ecs-tasks.amazonaws.com\n        Version: \"2012-10-17\"\n      ManagedPolicyArns:\n        - Fn::Join:\n            - \"\"\n            - - \"arn:\"\n              - Ref: AWS::Partition\n              - :iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/ecsTaskExecutionRole/Resource\n  ecsTaskExecutionRoleArn8D424356:\n    Type: AWS::SSM::Parameter\n    Properties:\n      Type: String\n      Value:\n        Fn::GetAtt:\n          - ecsTaskExecutionRole34F54B99\n          - Arn\n      Name: /laravel-demo/production/ecsTaskExecutionRoleArn\n      Tags:\n        branch: master\n        service: laravel-demo\n        stack_type: cdk\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/ecsTaskExecutionRoleArn/Resource\n  laravelTaskDef9B0924CC:\n    Type: AWS::ECS::TaskDefinition\n    Properties:\n      ContainerDefinitions:\n        - DependsOn:\n            - Condition: START\n              ContainerName: laravelServiceContainer\n          Essential: true\n          Image:\n            Fn::Join:\n              - \"\"\n              - - Ref: AWS::AccountId\n                - .dkr.ecr.\n                - Ref: AWS::Region\n                - \".\"\n                - Ref: AWS::URLSuffix\n                - /cdk_laravel/nginx:latest\n          LogConfiguration:\n            LogDriver: awslogs\n            Options:\n              awslogs-group:\n                Ref: nginxServiceLogGroupB4B3D26C\n              awslogs-stream-prefix: nginxService\n              awslogs-region:\n                Ref: AWS::Region\n          Name: nginxServiceContainer\n          PortMappings:\n            - ContainerPort: 80\n              Protocol: tcp\n        - Environment:\n            - Name: APP_NAME\n              Value: laravel\n            - Name: APP_KEY\n              Value: base64:SRLF3MRn3osyurFAVuqDgl82xznZk+y9TfFebyUALEY=\n            - Name: APP_DEBUG\n              Value: \"true\"\n            - Name: DB_CONNECTION\n              Value: mysql\n            - Name: DB_HOST\n              Value:\n                Fn::ImportValue: laravel-demo-rds-prod:ExportsOutputFnGetAttlaraveldemordsproddbclusterF7758E8AEndpointAddress9061C29D\n            - Name: DB_PORT\n              Value: \"3306\"\n            - Name: DB_DATABASE\n              Value: laravel_production\n            - Name: DB_USERNAME\n              Value: admin\n            - Name: DB_PASSWORD\n              Value:\n                Fn::Join:\n                  - \"\"\n                  - - \"{{resolve:secretsmanager:\"\n                    - Fn::ImportValue: laravel-demo-rds-prod:ExportsOutputReflaraveldemordsproddbclusterSecretAttachment6180E7E5F99B0069\n                    - :SecretString:password::}}\n            - Name: REDIS_HOST\n              Value:\n                Fn::ImportValue: laravel-demo-cache-prod:ExportsOutputFnGetAttlaraveldemocacheprodclusterRedisEndpointAddress73ECA523\n            - Name: REDIS_DB\n              Value: \"0\"\n          Essential: true\n          Image:\n            Fn::Join:\n              - \"\"\n              - - Ref: AWS::AccountId\n                - .dkr.ecr.\n                - Ref: AWS::Region\n                - \".\"\n                - Ref: AWS::URLSuffix\n                - /cdk_laravel/laravel:latest\n          LogConfiguration:\n            LogDriver: awslogs\n            Options:\n              awslogs-group:\n                Ref: laravelServiceLogGroup6D18D8A9\n              awslogs-stream-prefix: laravelService\n              awslogs-region:\n                Ref: AWS::Region\n          Name: laravelServiceContainer\n          PortMappings:\n            - ContainerPort: 9000\n              Protocol: tcp\n      Cpu: \"256\"\n      ExecutionRoleArn:\n        Fn::GetAtt:\n          - laravelTaskDefExecutionRoleE5E3154E\n          - Arn\n      Family: laraveldemoservicemasterlaravelTaskDef3FA03AF9\n      Memory: \"512\"\n      NetworkMode: awsvpc\n      RequiresCompatibilities:\n        - FARGATE\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n      TaskRoleArn:\n        Fn::GetAtt:\n          - ecsTaskExecutionRole34F54B99\n          - Arn\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravelTaskDef/Resource\n  laravelTaskDefExecutionRoleE5E3154E:\n    Type: AWS::IAM::Role\n    Properties:\n      AssumeRolePolicyDocument:\n        Statement:\n          - Action: sts:AssumeRole\n            Effect: Allow\n            Principal:\n              Service: ecs-tasks.amazonaws.com\n        Version: \"2012-10-17\"\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravelTaskDef/ExecutionRole/Resource\n  laravelTaskDefExecutionRoleDefaultPolicy010FF438:\n    Type: AWS::IAM::Policy\n    Properties:\n      PolicyDocument:\n        Statement:\n          - Action:\n              - ecr:BatchCheckLayerAvailability\n              - ecr:GetDownloadUrlForLayer\n              - ecr:BatchGetImage\n            Effect: Allow\n            Resource:\n              Fn::Join:\n                - \"\"\n                - - \"arn:\"\n                  - Ref: AWS::Partition\n                  - \":ecr:\"\n                  - Ref: AWS::Region\n                  - \":\"\n                  - Ref: AWS::AccountId\n                  - :repository/cdk_laravel/nginx\n          - Action: ecr:GetAuthorizationToken\n            Effect: Allow\n            Resource: \"*\"\n          - Action:\n              - logs:CreateLogStream\n              - logs:PutLogEvents\n            Effect: Allow\n            Resource:\n              Fn::GetAtt:\n                - nginxServiceLogGroupB4B3D26C\n                - Arn\n          - Action:\n              - ecr:BatchCheckLayerAvailability\n              - ecr:GetDownloadUrlForLayer\n              - ecr:BatchGetImage\n            Effect: Allow\n            Resource:\n              Fn::Join:\n                - \"\"\n                - - \"arn:\"\n                  - Ref: AWS::Partition\n                  - \":ecr:\"\n                  - Ref: AWS::Region\n                  - \":\"\n                  - Ref: AWS::AccountId\n                  - :repository/cdk_laravel/laravel\n          - Action:\n              - logs:CreateLogStream\n              - logs:PutLogEvents\n            Effect: Allow\n            Resource:\n              Fn::GetAtt:\n                - laravelServiceLogGroup6D18D8A9\n                - Arn\n        Version: \"2012-10-17\"\n      PolicyName: laravelTaskDefExecutionRoleDefaultPolicy010FF438\n      Roles:\n        - Ref: laravelTaskDefExecutionRoleE5E3154E\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravelTaskDef/ExecutionRole/DefaultPolicy/Resource\n  nginxServiceLogGroupB4B3D26C:\n    Type: AWS::Logs::LogGroup\n    Properties:\n      LogGroupName: /ecs/nginxService\n      RetentionInDays: 731\n    UpdateReplacePolicy: Delete\n    DeletionPolicy: Delete\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/nginxServiceLogGroup/Resource\n  laravelServiceLogGroup6D18D8A9:\n    Type: AWS::Logs::LogGroup\n    Properties:\n      LogGroupName: /ecs/laravelService\n      RetentionInDays: 731\n    UpdateReplacePolicy: Delete\n    DeletionPolicy: Delete\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravelServiceLogGroup/Resource\n  laravelServiceSecurityGroupD5E7525B:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: laravel-demo-service-master/laravelServiceSecurityGroup\n      GroupName: laravelServiceSecurityGroup\n      SecurityGroupEgress:\n        - CidrIp: 0.0.0.0/0\n          Description: Allow all outbound traffic by default\n          IpProtocol: \"-1\"\n      SecurityGroupIngress:\n        - CidrIp: 0.0.0.0/0\n          Description: from 0.0.0.0/0:80\n          FromPort: 80\n          IpProtocol: tcp\n          ToPort: 80\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n      VpcId:\n        Fn::ImportValue: laravel-demo-vpc:ExportsOutputReflaraveldemovpcvpcD90D1D43F0199DB5\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravelServiceSecurityGroup/Resource\n  laravelServiceSecurityGroupfromlaraveldemoservicemasterhttpapiInternalALBSecurityGroupA4E64AFE802DB12290:\n    Type: AWS::EC2::SecurityGroupIngress\n    Properties:\n      IpProtocol: tcp\n      Description: Load balancer to target\n      FromPort: 80\n      GroupId:\n        Fn::GetAtt:\n          - laravelServiceSecurityGroupD5E7525B\n          - GroupId\n      SourceSecurityGroupId:\n        Fn::GetAtt:\n          - httpapiInternalALBSecurityGroup65B6A92E\n          - GroupId\n      ToPort: 80\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravelServiceSecurityGroup/from laraveldemoservicemasterhttpapiInternalALBSecurityGroupA4E64AFE:80\n  laravelServiceSecurityGroupfromlaraveldemoservicemasteralbServiceSecurityGroup5506F22980F8918595:\n    Type: AWS::EC2::SecurityGroupIngress\n    Properties:\n      IpProtocol: tcp\n      Description: Load balancer to target\n      FromPort: 80\n      GroupId:\n        Fn::GetAtt:\n          - laravelServiceSecurityGroupD5E7525B\n          - GroupId\n      SourceSecurityGroupId:\n        Fn::GetAtt:\n          - albServiceSecurityGroupE08373D7\n          - GroupId\n      ToPort: 80\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravelServiceSecurityGroup/from laraveldemoservicemasteralbServiceSecurityGroup5506F229:80\n  laravelSecurityGroupAE547D75:\n    Type: AWS::SSM::Parameter\n    Properties:\n      Type: String\n      Value: laraveldemoservicemasterlaravelServiceSecurityGroup1CB140EE\n      Name: /laravel-demo/production/laravelSecurityGroup\n      Tags:\n        branch: master\n        service: laravel-demo\n        stack_type: cdk\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravelSecurityGroup/Resource\n  laravelService5A497BF3:\n    Type: AWS::ECS::Service\n    Properties:\n      Cluster:\n        Ref: FargateCluster955EED67\n      DeploymentConfiguration:\n        MaximumPercent: 200\n        MinimumHealthyPercent: 50\n      DeploymentController:\n        Type: CODE_DEPLOY\n      DesiredCount: 2\n      EnableECSManagedTags: false\n      HealthCheckGracePeriodSeconds: 60\n      LaunchType: FARGATE\n      LoadBalancers:\n        - ContainerName: nginxServiceContainer\n          ContainerPort: 80\n          TargetGroupArn:\n            Ref: nginxServiceTargetGroup1DF478BA1\n        - ContainerName: nginxServiceContainer\n          ContainerPort: 80\n          TargetGroupArn:\n            Ref: nginxServiceTargetGroup2C97A7178\n      NetworkConfiguration:\n        AwsvpcConfiguration:\n          AssignPublicIp: DISABLED\n          SecurityGroups:\n            - Fn::GetAtt:\n                - laravelServiceSecurityGroupD5E7525B\n                - GroupId\n          Subnets:\n            - Fn::ImportValue: laravel-demo-vpc:ExportsOutputReflaraveldemovpcvpcPrivateSubnet1SubnetE912F18CA702CED7\n            - Fn::ImportValue: laravel-demo-vpc:ExportsOutputReflaraveldemovpcvpcPrivateSubnet2SubnetB4B0E3B9E9A9AE2D\n      ServiceRegistries:\n        - RegistryArn:\n            Fn::GetAtt:\n              - laravelServiceCloudmapServiceCAE3C038\n              - Arn\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n      TaskDefinition:\n        Ref: laravelTaskDef9B0924CC\n    DependsOn:\n      - httpapiInternalALBhttpsapiListener00C7C8A5\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravelService/Service\n  laravelServiceCloudmapServiceCAE3C038:\n    Type: AWS::ServiceDiscovery::Service\n    Properties:\n      DnsConfig:\n        DnsRecords:\n          - TTL: 60\n            Type: A\n        NamespaceId:\n          Fn::GetAtt:\n            - DnsNamespaceE8F044C2\n            - Id\n        RoutingPolicy: MULTIVALUE\n      HealthCheckCustomConfig:\n        FailureThreshold: 1\n      Name: laravelService\n      NamespaceId:\n        Fn::GetAtt:\n          - DnsNamespaceE8F044C2\n          - Id\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravelService/CloudmapService/Resource\n  laravelServiceArn6F28DCC4:\n    Type: AWS::SSM::Parameter\n    Properties:\n      Type: String\n      Value:\n        Ref: laravelService5A497BF3\n      Name: /laravel-demo/production/laravelServiceArn\n      Tags:\n        branch: master\n        service: laravel-demo\n        stack_type: cdk\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/laravelServiceArn/Resource\n  albServiceSecurityGroupE08373D7:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: laravel-demo-service-master/albServiceSecurityGroup\n      GroupName: laravelAlbSecurityGroup\n      SecurityGroupEgress:\n        - CidrIp: 0.0.0.0/0\n          Description: Allow all outbound traffic by default\n          IpProtocol: \"-1\"\n      SecurityGroupIngress:\n        - CidrIp: 0.0.0.0/0\n          Description: from 0.0.0.0/0:80\n          FromPort: 80\n          IpProtocol: tcp\n          ToPort: 80\n        - CidrIp: 0.0.0.0/0\n          Description: from 0.0.0.0/0:443\n          FromPort: 443\n          IpProtocol: tcp\n          ToPort: 443\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n      VpcId:\n        Fn::ImportValue: laravel-demo-vpc:ExportsOutputReflaraveldemovpcvpcD90D1D43F0199DB5\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/albServiceSecurityGroup/Resource\n  httpapiInternalALB0B72E2FE:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n    Properties:\n      LoadBalancerAttributes:\n        - Key: deletion_protection.enabled\n          Value: \"false\"\n      Scheme: internet-facing\n      SecurityGroups:\n        - Fn::GetAtt:\n            - httpapiInternalALBSecurityGroup65B6A92E\n            - GroupId\n        - Fn::GetAtt:\n            - albServiceSecurityGroupE08373D7\n            - GroupId\n      Subnets:\n        - Fn::ImportValue: laravel-demo-vpc:ExportsOutputReflaraveldemovpcvpcPublicSubnet1Subnet1B8207B187614F0C\n        - Fn::ImportValue: laravel-demo-vpc:ExportsOutputReflaraveldemovpcvpcPublicSubnet2SubnetEE1B34FFE5748C15\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n      Type: application\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/httpapiInternalALB/Resource\n  httpapiInternalALBSecurityGroup65B6A92E:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Automatically created Security Group for ELB laraveldemoservicemasterhttpapiInternalALBD351F4C4\n      SecurityGroupIngress:\n        - CidrIp: 0.0.0.0/0\n          Description: Allow from anyone on port 80\n          FromPort: 80\n          IpProtocol: tcp\n          ToPort: 80\n        - CidrIp: 0.0.0.0/0\n          Description: Allow from anyone on port 443\n          FromPort: 443\n          IpProtocol: tcp\n          ToPort: 443\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n      VpcId:\n        Fn::ImportValue: laravel-demo-vpc:ExportsOutputReflaraveldemovpcvpcD90D1D43F0199DB5\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/httpapiInternalALB/SecurityGroup/Resource\n  httpapiInternalALBSecurityGrouptolaraveldemoservicemasterlaravelServiceSecurityGroup1CB140EE8091EC6FC7:\n    Type: AWS::EC2::SecurityGroupEgress\n    Properties:\n      GroupId:\n        Fn::GetAtt:\n          - httpapiInternalALBSecurityGroup65B6A92E\n          - GroupId\n      IpProtocol: tcp\n      Description: Load balancer to target\n      DestinationSecurityGroupId:\n        Fn::GetAtt:\n          - laravelServiceSecurityGroupD5E7525B\n          - GroupId\n      FromPort: 80\n      ToPort: 80\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/httpapiInternalALB/SecurityGroup/to laraveldemoservicemasterlaravelServiceSecurityGroup1CB140EE:80\n  httpapiInternalALBRedirect80To443F1851F11:\n    Type: AWS::ElasticLoadBalancingV2::Listener\n    Properties:\n      DefaultActions:\n        - RedirectConfig:\n            Port: \"443\"\n            Protocol: HTTPS\n            StatusCode: HTTP_301\n          Type: redirect\n      LoadBalancerArn:\n        Ref: httpapiInternalALB0B72E2FE\n      Port: 80\n      Protocol: HTTP\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/httpapiInternalALB/Redirect80To443/Resource\n  httpapiInternalALBhttpsapiListener00C7C8A5:\n    Type: AWS::ElasticLoadBalancingV2::Listener\n    Properties:\n      DefaultActions:\n        - ForwardConfig:\n            TargetGroupStickinessConfig:\n              DurationSeconds: 3600\n              Enabled: true\n            TargetGroups:\n              - TargetGroupArn:\n                  Ref: nginxServiceTargetGroup1DF478BA1\n                Weight: 50\n              - TargetGroupArn:\n                  Ref: nginxServiceTargetGroup2C97A7178\n                Weight: 50\n          Type: forward\n      LoadBalancerArn:\n        Ref: httpapiInternalALB0B72E2FE\n      Certificates:\n        - CertificateArn:\n            Fn::GetAtt:\n              - albSiteCertificateCertificateRequestorResource5E725017\n              - Arn\n      Port: 443\n      Protocol: HTTPS\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/httpapiInternalALB/httpsapiListener/Resource\n  albSiteCertificateCertificateRequestorFunctionServiceRoleBDFF1621:\n    Type: AWS::IAM::Role\n    Properties:\n      AssumeRolePolicyDocument:\n        Statement:\n          - Action: sts:AssumeRole\n            Effect: Allow\n            Principal:\n              Service: lambda.amazonaws.com\n        Version: \"2012-10-17\"\n      ManagedPolicyArns:\n        - Fn::Join:\n            - \"\"\n            - - \"arn:\"\n              - Ref: AWS::Partition\n              - :iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/albSiteCertificate/CertificateRequestorFunction/ServiceRole/Resource\n  albSiteCertificateCertificateRequestorFunctionServiceRoleDefaultPolicy923332B2:\n    Type: AWS::IAM::Policy\n    Properties:\n      PolicyDocument:\n        Statement:\n          - Action:\n              - acm:RequestCertificate\n              - acm:DescribeCertificate\n              - acm:DeleteCertificate\n            Effect: Allow\n            Resource: \"*\"\n          - Action: route53:GetChange\n            Effect: Allow\n            Resource: \"*\"\n          - Action: route53:changeResourceRecordSets\n            Effect: Allow\n            Resource:\n              Fn::Join:\n                - \"\"\n                - - \"arn:\"\n                  - Ref: AWS::Partition\n                  - :route53:::hostedzone/Z016552312S0N2LCUKQCF\n        Version: \"2012-10-17\"\n      PolicyName: albSiteCertificateCertificateRequestorFunctionServiceRoleDefaultPolicy923332B2\n      Roles:\n        - Ref: albSiteCertificateCertificateRequestorFunctionServiceRoleBDFF1621\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/albSiteCertificate/CertificateRequestorFunction/ServiceRole/DefaultPolicy/Resource\n  albSiteCertificateCertificateRequestorFunction5F9AE770:\n    Type: AWS::Lambda::Function\n    Properties:\n      Code:\n        S3Bucket:\n          Ref: AssetParameters19e461d2ff1a5b90438fed6ceee4c197d7efee8712a6f76d85b501ab20bfb1a2S3BucketFCCD3A76\n        S3Key:\n          Fn::Join:\n            - \"\"\n            - - Fn::Select:\n                  - 0\n                  - Fn::Split:\n                      - \"||\"\n                      - Ref: AssetParameters19e461d2ff1a5b90438fed6ceee4c197d7efee8712a6f76d85b501ab20bfb1a2S3VersionKey07AF06B6\n              - Fn::Select:\n                  - 1\n                  - Fn::Split:\n                      - \"||\"\n                      - Ref: AssetParameters19e461d2ff1a5b90438fed6ceee4c197d7efee8712a6f76d85b501ab20bfb1a2S3VersionKey07AF06B6\n      Role:\n        Fn::GetAtt:\n          - albSiteCertificateCertificateRequestorFunctionServiceRoleBDFF1621\n          - Arn\n      Handler: index.certificateRequestHandler\n      Runtime: nodejs10.x\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n      Timeout: 900\n    DependsOn:\n      - albSiteCertificateCertificateRequestorFunctionServiceRoleDefaultPolicy923332B2\n      - albSiteCertificateCertificateRequestorFunctionServiceRoleBDFF1621\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/albSiteCertificate/CertificateRequestorFunction/Resource\n      aws:asset:path: asset.19e461d2ff1a5b90438fed6ceee4c197d7efee8712a6f76d85b501ab20bfb1a2\n      aws:asset:property: Code\n  albSiteCertificateCertificateRequestorResource5E725017:\n    Type: AWS::CloudFormation::CustomResource\n    Properties:\n      ServiceToken:\n        Fn::GetAtt:\n          - albSiteCertificateCertificateRequestorFunction5F9AE770\n          - Arn\n      DomainName: kodespace.co.uk\n      SubjectAlternativeNames:\n        - \"*.kodespace.co.uk\"\n      HostedZoneId: Z016552312S0N2LCUKQCF\n    UpdateReplacePolicy: Delete\n    DeletionPolicy: Delete\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/albSiteCertificate/CertificateRequestorResource/Default\n  nginxServiceTargetGroup1DF478BA1:\n    Type: AWS::ElasticLoadBalancingV2::TargetGroup\n    Properties:\n      HealthCheckIntervalSeconds: 30\n      HealthCheckPath: /login\n      HealthCheckTimeoutSeconds: 3\n      Port: 80\n      Protocol: HTTP\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n      TargetGroupAttributes:\n        - Key: stickiness.enabled\n          Value: \"true\"\n        - Key: stickiness.type\n          Value: lb_cookie\n        - Key: stickiness.lb_cookie.duration_seconds\n          Value: \"86500\"\n      TargetType: ip\n      VpcId:\n        Fn::ImportValue: laravel-demo-vpc:ExportsOutputReflaraveldemovpcvpcD90D1D43F0199DB5\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/nginxServiceTargetGroup1/Resource\n  nginxServiceTargetGroup2C97A7178:\n    Type: AWS::ElasticLoadBalancingV2::TargetGroup\n    Properties:\n      HealthCheckIntervalSeconds: 30\n      HealthCheckPath: /login\n      HealthCheckTimeoutSeconds: 3\n      Port: 80\n      Protocol: HTTP\n      Tags:\n        - Key: branch\n          Value: master\n        - Key: service\n          Value: laravel-demo\n        - Key: stack_type\n          Value: cdk\n      TargetGroupAttributes:\n        - Key: stickiness.enabled\n          Value: \"true\"\n        - Key: stickiness.type\n          Value: lb_cookie\n        - Key: stickiness.lb_cookie.duration_seconds\n          Value: \"86500\"\n      TargetType: ip\n      VpcId:\n        Fn::ImportValue: laravel-demo-vpc:ExportsOutputReflaraveldemovpcvpcD90D1D43F0199DB5\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/nginxServiceTargetGroup2/Resource\n  AlbAliasRecord34710EAC:\n    Type: AWS::Route53::RecordSet\n    Properties:\n      Name: www.kodespace.co.uk.\n      Type: A\n      AliasTarget:\n        DNSName:\n          Fn::Join:\n            - \"\"\n            - - dualstack.\n              - Fn::GetAtt:\n                  - httpapiInternalALB0B72E2FE\n                  - DNSName\n        HostedZoneId:\n          Fn::GetAtt:\n            - httpapiInternalALB0B72E2FE\n            - CanonicalHostedZoneID\n      HostedZoneId: Z016552312S0N2LCUKQCF\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/AlbAliasRecord/Resource\n  AlbAliasRecord2076C4279:\n    Type: AWS::Route53::RecordSet\n    Properties:\n      Name: kodespace.co.uk.\n      Type: A\n      AliasTarget:\n        DNSName:\n          Fn::Join:\n            - \"\"\n            - - dualstack.\n              - Fn::GetAtt:\n                  - httpapiInternalALB0B72E2FE\n                  - DNSName\n        HostedZoneId:\n          Fn::GetAtt:\n            - httpapiInternalALB0B72E2FE\n            - CanonicalHostedZoneID\n      HostedZoneId: Z016552312S0N2LCUKQCF\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/AlbAliasRecord2/Resource\n  CDKMetadata:\n    Type: AWS::CDK::Metadata\n    Properties:\n      Analytics: v2:deflate64:H4sIAAAAAAAAE31TwW7bMAz9lt0VdVnQw25LnGUY0A2BU2xnRmYMNrZkiJKHwPC/j4rtxO2KnfT4+ERST9JSf17pjx++wB9emOL80BnnUXeHAOasMmc5+GiCypFd9AZVdrI/oGnIlmrNjEGEZQqyyMHVc9kc78FDjQF9CqRqQYGc7VXq2vFKd5tozhhSdkTDsncVmcudHuJemcrF4uSdDbrLEt4l/BuPW5KB6RhT+bRtHvfKuxjwUdqtc5RzFsOYCR0w9AoNp3JyknHQEe7AlxDwGfi8xRNZmqq/ZWQGIIt+xo17D+hbGrwYYa+Y62S0F/te+XMLRDJoC2LjWvQX3e09tVJva/mniLiB0eB36Pd6EkjP3FXDDaX1bvFkbuVK8eHJld/EryZlJpws8jrHxjEF5y8bYBTqkxwDTfQULrct/ye+29Ij8z/81ystbSrgQHLLUByhAmvEo1barJtGZoTk7JPkNtfc4NqreK6TF4B21Ex4ln+WC8JwG3MWyjNDH+iUhFiDhRK9Fod/QUWFUEV2T6sK6mMButtFa6bnMWG5x9UC0m9hff00fa+sK1C/8EO7fNTLpfzAFyZa+GgD1ajzYf0LIIJAr50DAAA=\n    Metadata:\n      aws:cdk:path: laravel-demo-service-master/CDKMetadata/Default\n    Condition: CDKMetadataAvailable\nMappings:\n  AWSCloudFrontPartitionHostedZoneIdMap:\n    aws:\n      zoneId: Z2FDTNDATAQYW2\n    aws-cn:\n      zoneId: Z3RFFRIM2A3IF5\nParameters:\n  AssetParameters19e461d2ff1a5b90438fed6ceee4c197d7efee8712a6f76d85b501ab20bfb1a2S3BucketFCCD3A76:\n    Type: String\n    Description: S3 bucket for asset \"19e461d2ff1a5b90438fed6ceee4c197d7efee8712a6f76d85b501ab20bfb1a2\"\n  AssetParameters19e461d2ff1a5b90438fed6ceee4c197d7efee8712a6f76d85b501ab20bfb1a2S3VersionKey07AF06B6:\n    Type: String\n    Description: S3 key for asset version \"19e461d2ff1a5b90438fed6ceee4c197d7efee8712a6f76d85b501ab20bfb1a2\"\n  AssetParameters19e461d2ff1a5b90438fed6ceee4c197d7efee8712a6f76d85b501ab20bfb1a2ArtifactHash652C125C:\n    Type: String\n    Description: Artifact hash for asset \"19e461d2ff1a5b90438fed6ceee4c197d7efee8712a6f76d85b501ab20bfb1a2\"\nConditions:\n  CDKMetadataAvailable:\n    Fn::Or:\n      - Fn::Or:\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - ap-east-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - ap-northeast-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - ap-northeast-2\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - ap-south-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - ap-southeast-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - ap-southeast-2\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - ca-central-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - cn-north-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - cn-northwest-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - eu-central-1\n      - Fn::Or:\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - eu-north-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - eu-west-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - eu-west-2\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - eu-west-3\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - me-south-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - sa-east-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - us-east-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - us-east-2\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - us-west-1\n          - Fn::Equals:\n              - Ref: AWS::Region\n              - us-west-2\n"
